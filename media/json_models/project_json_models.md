# Project JSON Models (DocsAI)

This document describes the **project** JSON structures used in the Contact360 DocsAI codebase. The **project** resource type refers to analysis, inventory, and validation JSON files under `media/project/`. These are **not** validated by Pydantic documentation schemas; they are generated by scripts and consumed by reports and dashboards.

---

## 1. Overview

- **Storage**: `media/project/*.json` (and sibling `.md` reports).
- **Purpose**: Inventories, validation results, consistency checks, and gap analysis for pages, endpoints, and relationships.
- **Validation**: No canonical Pydantic schema; `normalize_media_files` only checks that project JSON files are **well-formed** (valid JSON). Structure is defined by the scripts that generate them.
- **Paths**: `apps/documentation/utils/paths.py` → `get_project_dir()`.

---

## 2. Resource Type and Media Manager

- **Resource type**: `project`.
- **Media Manager**: `apps/documentation/services/media_manager_service.py` and `media_file_manager.py` include `project` in `resource_types` and resolve paths via `get_project_dir()`.
- **Operations**: `apps/documentation/views/operations.py` and dashboard list `resource_types`: `["pages", "endpoints", "relationships", "postman", "n8n", "project"]`.
- **Scan**: `normalize_media_files` runs `_scan_project_json()` to verify all `*.json` under `media/project/` are valid JSON (no schema enforcement).

---

## 3. Inventory JSON Models

These files are generated by analysis/scripts and follow a consistent pattern.

### 3.1 Pages Inventory: `01_pages_inventory.json`

| Field | Type | Description |
|-------|------|-------------|
| `inventory_date` | string | Date of inventory (e.g. `2026-01-20`). |
| `total_pages` | integer | Total number of pages. |
| `pages_by_type` | object | Counts by `page_type` (e.g. `dashboard`, `marketing`, `auth`). |
| `pages` | array | List of page summary objects. |

**Page summary object** (each item in `pages`):

| Field | Type | Description |
|-------|------|-------------|
| `page_id` | string | Page identifier. |
| `page_type` | string | e.g. `dashboard`, `marketing`, `auth`. |
| `route` | string | Page route (e.g. `/companies`). |
| `status` | string | e.g. `published`. |
| `authentication` | string | e.g. `Required`, `Not required`. |
| `authorization` | string \| null | Authorization notes. |
| `endpoint_count` | integer | Number of endpoints used. |
| `component_count` | integer | Number of UI components. |
| `api_versions` | array | e.g. `["graphql"]`. |
| `purpose` | string | Page purpose/description. |

---

### 3.2 Endpoints Inventory: `02_endpoints_inventory.json`

| Field | Type | Description |
|-------|------|-------------|
| `inventory_date` | string | Date of inventory. |
| `total_endpoints` | integer | Total number of endpoints. |
| `endpoints_by_method` | object | Counts by method (e.g. `QUERY`, `MUTATION`). |
| `endpoints_by_api_version` | object | Counts by `api_version` (e.g. `graphql`). |
| `endpoint_categories` | object | Category name → list of `endpoint_id`. |
| `authentication_distribution` | object | Auth type → count. |
| `authorization_distribution` | object | Authorization type → count. |
| `endpoints_with_pages` | integer | Endpoints that have at least one page. |
| `endpoints_without_pages` | integer | Endpoints with no page usage. |
| `most_used_endpoints` | array | Objects: `endpoint_id`, `page_count`, `endpoint_path`. |

---

### 3.3 Relationships Inventory: `03_relationships_inventory.json`

Structure follows the same pattern: inventory date, totals, breakdowns, and list of relationship summaries. Exact fields depend on the script that generates this file.

---

## 4. Validation and Consistency JSON Models

### 4.1 Validation Errors: `07_validation_errors.json`

| Field | Type | Description |
|-------|------|-------------|
| `validation_date` | string | Date of validation run. |
| `overall_status` | string | e.g. `good`. |
| `critical_issues` | integer | Count of critical issues. |
| `warnings` | integer | Count of warnings. |
| `errors` | integer | Count of errors. |
| `issues` | array | List of issue objects. |

**Issue object**:

| Field | Type | Description |
|-------|------|-------------|
| `severity` | string | e.g. `critical`, `warning`. |
| `category` | string | e.g. `schema_mismatch`. |
| `collection` | string | e.g. `pages`, `endpoints`. |
| `issue` | string | Description of the issue. |
| `schema_expects` | string \| array | What the schema expects. |
| `actual_value` | string \| array | Actual value(s). |
| `affected_files` | integer | Number of affected files. |
| `affected_pages` | array \| null | Page IDs (if applicable). |
| `recommendation` | string | Suggested fix. |

---

### 4.2 Inconsistencies: `08_inconsistencies.json`

Structure is script-defined; typically lists inconsistencies between pages, endpoints, and relationships (e.g. missing links, mismatched IDs).

---

### 4.3 Missing Data: `09_missing_data.json`

Structure is script-defined; typically lists missing or incomplete data (e.g. pages without endpoints, endpoints without documentation).

---

## 5. No Canonical Schema

- **DocsAI** does **not** define Pydantic or dict validators for project JSON.
- **Normalization**: `normalize_media_files` only ensures:
  - Files under `media/project/*.json` parse as valid JSON.
  - No structural or field-level validation is applied.
- **Consumption**: Project JSON is read by report views, dashboards, and scripts; consumers must tolerate evolving shapes.

---

## 6. Code References

- **Paths**: `get_project_dir()` in `apps/documentation/utils/paths.py` returns `get_media_root() / "project"`.
- **Scan**: `_scan_project_json()` in `apps/documentation/management/commands/normalize_media_files.py` (valid JSON only).
- **Resource type**: `resource_type == "project"` in `media_manager_service.py`, `media_file_manager.py`, `file_operations.py`.
